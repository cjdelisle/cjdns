function string_to_array(_){for(var H=_.length,A=new Array(H),r=0;H>r;r++)A[r]=_.charCodeAt(r);return A}function array_to_hex_string(_){for(var H="",A=0;A<_.length;A++)H+=SHA256_hexchars[_[A]>>4]+SHA256_hexchars[15&_[A]];return H}function SHA256_init(){SHA256_H=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),SHA256_buf=new Array,SHA256_len=0}function SHA256_write(_){"string"==typeof _?SHA256_buf=SHA256_buf.concat(string_to_array(_)):SHA256_buf=SHA256_buf.concat(_);for(var H=0;H+64<=SHA256_buf.length;H+=64)SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf.slice(H,H+64));SHA256_buf=SHA256_buf.slice(H),SHA256_len+=_.length}function SHA256_finalize(){if(SHA256_buf[SHA256_buf.length]=128,SHA256_buf.length>56){for(var _=SHA256_buf.length;64>_;_++)SHA256_buf[_]=0;SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf),SHA256_buf.length=0}for(var _=SHA256_buf.length;59>_;_++)SHA256_buf[_]=0;SHA256_buf[59]=SHA256_len>>>29&255,SHA256_buf[60]=SHA256_len>>>21&255,SHA256_buf[61]=SHA256_len>>>13&255,SHA256_buf[62]=SHA256_len>>>5&255,SHA256_buf[63]=SHA256_len<<3&255,SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf);for(var H=new Array(32),_=0;8>_;_++)H[4*_+0]=SHA256_H[_]>>>24,H[4*_+1]=SHA256_H[_]>>16&255,H[4*_+2]=SHA256_H[_]>>8&255,H[4*_+3]=255&SHA256_H[_];return delete SHA256_H,delete SHA256_buf,delete SHA256_len,H}function SHA256_hash(_){var H;return SHA256_init(),SHA256_write(_),H=SHA256_finalize(),array_to_hex_string(H)}function HMAC_SHA256_init(_){"string"==typeof _?HMAC_SHA256_key=string_to_array(_):HMAC_SHA256_key=(new Array).concat(_),HMAC_SHA256_key.length>64&&(SHA256_init(),SHA256_write(HMAC_SHA256_key),HMAC_SHA256_key=SHA256_finalize());for(var H=HMAC_SHA256_key.length;64>H;H++)HMAC_SHA256_key[H]=0;for(var H=0;64>H;H++)HMAC_SHA256_key[H]^=54;SHA256_init(),SHA256_write(HMAC_SHA256_key)}function HMAC_SHA256_write(_){SHA256_write(_)}function HMAC_SHA256_finalize(){for(var _=SHA256_finalize(),H=0;64>H;H++)HMAC_SHA256_key[H]^=106;SHA256_init(),SHA256_write(HMAC_SHA256_key),SHA256_write(_);for(var H=0;64>H;H++)HMAC_SHA256_key[H]=0;return delete HMAC_SHA256_key,SHA256_finalize()}function HMAC_SHA256_MAC(_,H){var A;return HMAC_SHA256_init(_),HMAC_SHA256_write(H),A=HMAC_SHA256_finalize(),array_to_hex_string(A)}function SHA256_sigma0(_){return(_>>>7|_<<25)^(_>>>18|_<<14)^_>>>3}function SHA256_sigma1(_){return(_>>>17|_<<15)^(_>>>19|_<<13)^_>>>10}function SHA256_Sigma0(_){return(_>>>2|_<<30)^(_>>>13|_<<19)^(_>>>22|_<<10)}function SHA256_Sigma1(_){return(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7)}function SHA256_Ch(_,H,A){return A^_&(H^A)}function SHA256_Maj(_,H,A){return _&H^A&(_^H)}function SHA256_Hash_Word_Block(_,H){for(var A=16;64>A;A++)H[A]=SHA256_sigma1(H[A-2])+H[A-7]+SHA256_sigma0(H[A-15])+H[A-16]&4294967295;for(var r=(new Array).concat(_),A=0;64>A;A++){var S=r[7]+SHA256_Sigma1(r[4])+SHA256_Ch(r[4],r[5],r[6])+SHA256_K[A]+H[A],n=SHA256_Sigma0(r[0])+SHA256_Maj(r[0],r[1],r[2]);r.pop(),r.unshift(S+n&4294967295),r[4]=r[4]+S&4294967295}for(var A=0;8>A;A++)_[A]=_[A]+r[A]&4294967295}function SHA256_Hash_Byte_Block(_,H){for(var A=new Array(16),r=0;16>r;r++)A[r]=H[4*r+0]<<24|H[4*r+1]<<16|H[4*r+2]<<8|H[4*r+3];SHA256_Hash_Word_Block(_,A)}SHA256_hexchars=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),SHA256_K=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);
